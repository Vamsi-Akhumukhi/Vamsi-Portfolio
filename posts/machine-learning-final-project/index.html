<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Machine Learning Algorithms (SVM, Log Regression and SGD) on Adult Dataset - Vamsi&#39;s Portfolio</title><meta name="Description" content="The aim of the following Project is to predict whether income of a person exceeds $50K/year based on Adult dataset . "><meta property="og:title" content="Machine Learning Algorithms (SVM, Log Regression and SGD) on Adult Dataset" />
<meta property="og:description" content="The aim of the following Project is to predict whether income of a person exceeds $50K/year based on Adult dataset . " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/machine-learning-final-project/" />
<meta property="og:image" content="https://vamsi-akhumukhi.github.io/logo.png"/>
<meta property="article:published_time" content="2020-09-05T00:58:26-04:00" />
<meta property="article:modified_time" content="2020-09-05T00:58:26-04:00" /><meta property="og:site_name" content="Vamsi&#39;s Portfolio" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://vamsi-akhumukhi.github.io/logo.png"/>

<meta name="twitter:title" content="Machine Learning Algorithms (SVM, Log Regression and SGD) on Adult Dataset"/>
<meta name="twitter:description" content="The aim of the following Project is to predict whether income of a person exceeds $50K/year based on Adult dataset . "/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/apple-touch-icon.png"><link rel="mask-icon" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/site.webmanifest"><link rel="canonical" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/machine-learning-final-project/" /><link rel="prev" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/ronaldo/" /><link rel="next" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/germany-world-cup/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Machine Learning Algorithms (SVM, Log Regression and SGD) on Adult Dataset",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/vamsi-akhumukhi.github.io\/Vamsi-Portfolio\/posts\/machine-learning-final-project\/"
        },"genre": "posts","keywords": "Linear Regression, SVM, SGD","wordcount":  4028 ,
        "url": "https:\/\/vamsi-akhumukhi.github.io\/Vamsi-Portfolio\/posts\/machine-learning-final-project\/","datePublished": "2020-09-05T00:58:26-04:00","dateModified": "2020-09-05T00:58:26-04:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Vamsi Akhumukhi"
            },"description": "The aim of the following Project is to predict whether income of a person exceeds $50K/year based on Adult dataset . "
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/" title="Vamsi&#39;s Portfolio">Vamsi Akhumukhi</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/"> Posts </a><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/tags/"> Tags </a><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/categories/"> Categories </a><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/about/"> About </a><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/leetcode/"> LeetCode </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/" title="Vamsi&#39;s Portfolio">Vamsi Akhumukhi</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/" title="">Posts</a><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/tags/" title="">Tags</a><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/categories/" title="">Categories</a><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/about/" title="">About</a><a class="menu-item" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/leetcode/" title="">LeetCode</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Machine Learning Algorithms (SVM, Log Regression and SGD) on Adult Dataset</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Vamsi Akhumukhi</a></span>&nbsp;<span class="post-category">included in <a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/categories/projects/"><i class="far fa-folder fa-fw"></i>Projects</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-09-05">2020-09-05</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;4028 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;19 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#importing-the-libraries">Importing the Libraries</a></li>
    <li><a href="#feature-engineering">Feature Engineering</a></li>
  </ul>

  <ul>
    <li><a href="#normalization">Normalization</a></li>
    <li><a href="#pca">PCA</a></li>
    <li><a href="#svm-on-training-dataset">SVM on Training Dataset</a></li>
    <li><a href="#svm-on-testing-dataset">SVM on Testing Dataset</a></li>
    <li><a href="#logistic-regression">Logistic regression</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>The aim of the following Project is to predict whether income of a person exceeds
$50K/year based on Adult dataset.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</code></pre></div><p>Mounted at /content/drive</p>
<h2 id="importing-the-libraries">Importing the Libraries</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="kn">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="kn">as</span> <span class="nn">animation</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</code></pre></div><p>/usr/local/lib/python3.7/dist-packages/statsmodels/tools/_testing.py:19: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas.util.testing</span> <span class="kn">as</span> <span class="nn">tm</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">fit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/My Drive/Machine Learning/adult_data.csv&#39;</span><span class="p">,</span><span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">fit</span><span class="p">]</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>WorkClass</th>
<th>Final_weight</th>
<th>Education</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Occupation</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
<th>Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>State-gov</td>
<td>77516</td>
<td>Bachelors</td>
<td>13</td>
<td>Never-married</td>
<td>Adm-clerical</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>2174</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>Self-emp-not-inc</td>
<td>83311</td>
<td>Bachelors</td>
<td>13</td>
<td>Married-civ-spouse</td>
<td>Exec-managerial</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>2</td>
<td>38</td>
<td>Private</td>
<td>215646</td>
<td>HS-grad</td>
<td>9</td>
<td>Divorced</td>
<td>Handlers-cleaners</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>3</td>
<td>53</td>
<td>Private</td>
<td>234721</td>
<td>11th</td>
<td>7</td>
<td>Married-civ-spouse</td>
<td>Handlers-cleaners</td>
<td>Husband</td>
<td>Black</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>4</td>
<td>28</td>
<td>Private</td>
<td>338409</td>
<td>Bachelors</td>
<td>13</td>
<td>Married-civ-spouse</td>
<td>Prof-specialty</td>
<td>Wife</td>
<td>Black</td>
<td>Female</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>Cuba</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>32556</td>
<td>27</td>
<td>Private</td>
<td>257302</td>
<td>Assoc-acdm</td>
<td>12</td>
<td>Married-civ-spouse</td>
<td>Tech-support</td>
<td>Wife</td>
<td>White</td>
<td>Female</td>
<td>0</td>
<td>0</td>
<td>38</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>32557</td>
<td>40</td>
<td>Private</td>
<td>154374</td>
<td>HS-grad</td>
<td>9</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&gt;50K</td>
</tr>
<tr>
<td>32558</td>
<td>58</td>
<td>Private</td>
<td>151910</td>
<td>HS-grad</td>
<td>9</td>
<td>Widowed</td>
<td>Adm-clerical</td>
<td>Unmarried</td>
<td>White</td>
<td>Female</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>32559</td>
<td>22</td>
<td>Private</td>
<td>201490</td>
<td>HS-grad</td>
<td>9</td>
<td>Never-married</td>
<td>Adm-clerical</td>
<td>Own-child</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>20</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>32560</td>
<td>52</td>
<td>Self-emp-inc</td>
<td>287927</td>
<td>HS-grad</td>
<td>9</td>
<td>Married-civ-spouse</td>
<td>Exec-managerial</td>
<td>Wife</td>
<td>White</td>
<td>Female</td>
<td>15024</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&gt;50K</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;WorkClass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div><pre><code>Private             22696
Self-emp-not-inc     2541
Local-gov            2093
?                    1836
State-gov            1298
Self-emp-inc         1116
Federal-gov           960
Without-pay            14
Never-worked            7
Name: WorkClass, dtype: int64
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[?]&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">fit</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">40</span><span class="p">])</span>
</code></pre></div><pre><code>    Age          WorkClass  ...  native_country  Salary
25   56          Local-gov  ...   United-States    &gt;50K
26   19            Private  ...   United-States   &lt;=50K
27   54                NaN  ...           South    &gt;50K
28   39            Private  ...   United-States   &lt;=50K
29   49            Private  ...   United-States   &lt;=50K
30   23          Local-gov  ...   United-States   &lt;=50K
31   20            Private  ...   United-States   &lt;=50K
32   45            Private  ...   United-States   &lt;=50K
33   30        Federal-gov  ...   United-States   &lt;=50K
34   22          State-gov  ...   United-States   &lt;=50K
35   48            Private  ...     Puerto-Rico   &lt;=50K
36   21            Private  ...   United-States   &lt;=50K
37   19            Private  ...   United-States   &lt;=50K
38   31            Private  ...             NaN    &gt;50K
39   48   Self-emp-not-inc  ...   United-States   &lt;=50K

[15 rows x 15 columns]
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python3" data-lang="python3"><span class="c1"># summarize the class distribution</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">counter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
	<span class="n">per</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Class=</span><span class="si">%s</span><span class="s1">, Count=</span><span class="si">%d</span><span class="s1">, Percentage=</span><span class="si">%.3f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">per</span><span class="p">))</span>
</code></pre></div><pre><code>Class= &lt;=50K, Count=24720, Percentage=75.919%
Class= &gt;50K, Count=7841, Percentage=24.081%
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">cbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,)</span>
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f455550f978&gt;
</code></pre>
<p><img
        class="lazyload"
        src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/svg/loading.min.svg"
        data-src="ML_Final_Project_files/ML_Final_Project_11_1.png"
        data-srcset="ML_Final_Project_files/ML_Final_Project_11_1.png, ML_Final_Project_files/ML_Final_Project_11_1.png 1.5x, ML_Final_Project_files/ML_Final_Project_11_1.png 2x"
        data-sizes="auto"
        alt="ML_Final_Project_files/ML_Final_Project_11_1.png"
        title="png" /></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">fit</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>WorkClass</th>
<th>Final_weight</th>
<th>Education</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Occupation</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
<th>Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>State-gov</td>
<td>77516</td>
<td>Bachelors</td>
<td>13</td>
<td>Never-married</td>
<td>Adm-clerical</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>2174</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>Self-emp-not-inc</td>
<td>83311</td>
<td>Bachelors</td>
<td>13</td>
<td>Married-civ-spouse</td>
<td>Exec-managerial</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>2</td>
<td>38</td>
<td>Private</td>
<td>215646</td>
<td>HS-grad</td>
<td>9</td>
<td>Divorced</td>
<td>Handlers-cleaners</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>3</td>
<td>53</td>
<td>Private</td>
<td>234721</td>
<td>11th</td>
<td>7</td>
<td>Married-civ-spouse</td>
<td>Handlers-cleaners</td>
<td>Husband</td>
<td>Black</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>4</td>
<td>28</td>
<td>Private</td>
<td>338409</td>
<td>Bachelors</td>
<td>13</td>
<td>Married-civ-spouse</td>
<td>Prof-specialty</td>
<td>Wife</td>
<td>Black</td>
<td>Female</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>Cuba</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>32556</td>
<td>27</td>
<td>Private</td>
<td>257302</td>
<td>Assoc-acdm</td>
<td>12</td>
<td>Married-civ-spouse</td>
<td>Tech-support</td>
<td>Wife</td>
<td>White</td>
<td>Female</td>
<td>0</td>
<td>0</td>
<td>38</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>32557</td>
<td>40</td>
<td>Private</td>
<td>154374</td>
<td>HS-grad</td>
<td>9</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&gt;50K</td>
</tr>
<tr>
<td>32558</td>
<td>58</td>
<td>Private</td>
<td>151910</td>
<td>HS-grad</td>
<td>9</td>
<td>Widowed</td>
<td>Adm-clerical</td>
<td>Unmarried</td>
<td>White</td>
<td>Female</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>32559</td>
<td>22</td>
<td>Private</td>
<td>201490</td>
<td>HS-grad</td>
<td>9</td>
<td>Never-married</td>
<td>Adm-clerical</td>
<td>Own-child</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>20</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr>
<td>32560</td>
<td>52</td>
<td>Self-emp-inc</td>
<td>287927</td>
<td>HS-grad</td>
<td>9</td>
<td>Married-civ-spouse</td>
<td>Exec-managerial</td>
<td>Wife</td>
<td>White</td>
<td>Female</td>
<td>15024</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&gt;50K</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div><pre><code> &lt;=50K    22654
 &gt;50K      7508
Name: Salary, dtype: int64
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">heatmapz</span>
</code></pre></div><pre><code>Collecting heatmapz
  Downloading https://files.pythonhosted.org/packages/26/5d/3928028fcb8de3bf09bb17975ca7e83f8b2f00cd28c10bc1150f8c418372/heatmapz-0.0.4-py3-none-any.whl
Requirement already satisfied: matplotlib&gt;=3.0.3 in /usr/local/lib/python3.6/dist-packages (from heatmapz) (3.2.1)
Requirement already satisfied: pandas in /usr/local/lib/python3.6/dist-packages (from heatmapz) (1.0.3)
Requirement already satisfied: seaborn in /usr/local/lib/python3.6/dist-packages (from heatmapz) (0.10.1)
Requirement already satisfied: numpy&gt;=1.11 in /usr/local/lib/python3.6/dist-packages (from matplotlib&gt;=3.0.3-&gt;heatmapz) (1.18.4)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib&gt;=3.0.3-&gt;heatmapz) (2.8.1)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib&gt;=3.0.3-&gt;heatmapz) (2.4.7)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib&gt;=3.0.3-&gt;heatmapz) (1.2.0)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.6/dist-packages (from matplotlib&gt;=3.0.3-&gt;heatmapz) (0.10.0)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas-&gt;heatmapz) (2018.9)
Requirement already satisfied: scipy&gt;=1.0.1 in /usr/local/lib/python3.6/dist-packages (from seaborn-&gt;heatmapz) (1.4.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.6/dist-packages (from python-dateutil&gt;=2.1-&gt;matplotlib&gt;=3.0.3-&gt;heatmapz) (1.12.0)
Installing collected packages: heatmapz
Successfully installed heatmapz-0.0.4
</code></pre>
<h2 id="feature-engineering">Feature Engineering</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Converting Salary to 0 and 1</span>
<span class="n">salary_map</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39; &lt;=50K&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; &gt;50K&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">salary_map</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><pre><code>0    1
1    1
2    1
3    1
4    1
5    1
6    1
7    0
8    0
9    0
Name: Salary, dtype: int64
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Converting Sex to integer</span>
<span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39; Male&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; Female&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span> <span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="k">print</span> <span class="p">((</span><span class="s2">&#34;-&#34;</span><span class="o">*</span><span class="mi">40</span><span class="p">))</span>
<span class="k">print</span> <span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</code></pre></div><pre><code>   Age          WorkClass  Final_weight  ... hours_per_week  native_country Salary
0   39          State-gov         77516  ...             40   United-States      1
1   50   Self-emp-not-inc         83311  ...             13   United-States      1
2   38            Private        215646  ...             40   United-States      1
3   53            Private        234721  ...             40   United-States      1
4   28            Private        338409  ...             40            Cuba      1
5   37            Private        284582  ...             40   United-States      1
6   49            Private        160187  ...             16         Jamaica      1
7   52   Self-emp-not-inc        209642  ...             45   United-States      0
8   31            Private         45781  ...             50   United-States      0
9   42            Private        159449  ...             40   United-States      0

[10 rows x 15 columns]
----------------------------------------
&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 30162 entries, 0 to 32560
Data columns (total 15 columns):
 #   Column          Non-Null Count  Dtype
---  ------          --------------  -----
 0   Age             30162 non-null  int64
 1   WorkClass       30162 non-null  object
 2   Final_weight    30162 non-null  int64
 3   Education       30162 non-null  object
 4   Education_num   30162 non-null  int64
 5   Martial_status  30162 non-null  object
 6   Occupation      30162 non-null  object
 7   Relationship    30162 non-null  object
 8   Race            30162 non-null  object
 9   Sex             30162 non-null  int64
 10  Capital_gain    30162 non-null  int64
 11  Capital_loss    30162 non-null  int64
 12  hours_per_week  30162 non-null  int64
 13  native_country  30162 non-null  object
 14  Salary          30162 non-null  int64
dtypes: int64(8), object(7)
memory usage: 3.7+ MB
None
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Categorize between US and Non -Us</span>
<span class="n">fit</span><span class="p">[</span><span class="s1">&#39;native_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div><pre><code>array([' United-States', ' Cuba', ' Jamaica', ' India', ' Mexico',
       ' Puerto-Rico', ' Honduras', ' England', ' Canada', ' Germany',
       ' Iran', ' Philippines', ' Poland', ' Columbia', ' Cambodia',
       ' Thailand', ' Ecuador', ' Laos', ' Taiwan', ' Haiti', ' Portugal',
       ' Dominican-Republic', ' El-Salvador', ' France', ' Guatemala',
       ' Italy', ' China', ' South', ' Japan', ' Yugoslavia', ' Peru',
       ' Outlying-US(Guam-USVI-etc)', ' Scotland', ' Trinadad&amp;Tobago',
       ' Greece', ' Nicaragua', ' Vietnam', ' Hong', ' Ireland',
       ' Hungary', ' Holand-Netherlands'], dtype=object)
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">fit</span><span class="p">]</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;native_country&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39; United-States&#39;</span><span class="p">,</span> <span class="s1">&#39;native_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Non-US&#39;</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;native_country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; United-States&#39;</span><span class="p">,</span> <span class="s1">&#39;native_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;US&#39;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>WorkClass</th>
<th>Final_weight</th>
<th>Education</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Occupation</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
<th>Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>State-gov</td>
<td>77516</td>
<td>Bachelors</td>
<td>13</td>
<td>Never-married</td>
<td>Adm-clerical</td>
<td>Not-in-family</td>
<td>White</td>
<td>1</td>
<td>2174</td>
<td>0</td>
<td>40</td>
<td>US</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>Self-emp-not-inc</td>
<td>83311</td>
<td>Bachelors</td>
<td>13</td>
<td>Married-civ-spouse</td>
<td>Exec-managerial</td>
<td>Husband</td>
<td>White</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>US</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>38</td>
<td>Private</td>
<td>215646</td>
<td>HS-grad</td>
<td>9</td>
<td>Divorced</td>
<td>Handlers-cleaners</td>
<td>Not-in-family</td>
<td>White</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>US</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>53</td>
<td>Private</td>
<td>234721</td>
<td>11th</td>
<td>7</td>
<td>Married-civ-spouse</td>
<td>Handlers-cleaners</td>
<td>Husband</td>
<td>Black</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>US</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>28</td>
<td>Private</td>
<td>338409</td>
<td>Bachelors</td>
<td>13</td>
<td>Married-civ-spouse</td>
<td>Prof-specialty</td>
<td>Wife</td>
<td>Black</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>Non-US</td>
<td>1</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>32556</td>
<td>27</td>
<td>Private</td>
<td>257302</td>
<td>Assoc-acdm</td>
<td>12</td>
<td>Married-civ-spouse</td>
<td>Tech-support</td>
<td>Wife</td>
<td>White</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>38</td>
<td>US</td>
<td>1</td>
</tr>
<tr>
<td>32557</td>
<td>40</td>
<td>Private</td>
<td>154374</td>
<td>HS-grad</td>
<td>9</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Husband</td>
<td>White</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>US</td>
<td>0</td>
</tr>
<tr>
<td>32558</td>
<td>58</td>
<td>Private</td>
<td>151910</td>
<td>HS-grad</td>
<td>9</td>
<td>Widowed</td>
<td>Adm-clerical</td>
<td>Unmarried</td>
<td>White</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>US</td>
<td>1</td>
</tr>
<tr>
<td>32559</td>
<td>22</td>
<td>Private</td>
<td>201490</td>
<td>HS-grad</td>
<td>9</td>
<td>Never-married</td>
<td>Adm-clerical</td>
<td>Own-child</td>
<td>White</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>20</td>
<td>US</td>
<td>1</td>
</tr>
<tr>
<td>32560</td>
<td>52</td>
<td>Self-emp-inc</td>
<td>287927</td>
<td>HS-grad</td>
<td>9</td>
<td>Married-civ-spouse</td>
<td>Exec-managerial</td>
<td>Wife</td>
<td>White</td>
<td>0</td>
<td>15024</td>
<td>0</td>
<td>40</td>
<td>US</td>
<td>0</td>
</tr>
<tr>
<td>30162 rows × 15 columns</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;native_country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;native_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;US&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Non-US&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">fit</span><span class="p">[</span><span class="s1">&#39;native_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><pre><code>0    1
1    1
2    1
3    1
4    0
5    1
6    0
7    1
8    1
9    1
Name: native_country, dtype: int64
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39; Divorced&#39;</span><span class="p">,</span>
                                                       <span class="s1">&#39; Married-spouse-absent&#39;</span><span class="p">,</span>
                                                       <span class="s1">&#39; Never-married&#39;</span><span class="p">,</span>
                                                       <span class="s1">&#39; Separated&#39;</span><span class="p">,</span>
                                                       <span class="s1">&#39; Widowed&#39;</span><span class="p">],</span>
                                                      <span class="s1">&#39;Single&#39;</span><span class="p">)</span>
<span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39; Married-AF-spouse&#39;</span><span class="p">,</span><span class="s1">&#39; Married-civ-spouse&#39;</span><span class="p">],</span><span class="s1">&#39;Couple&#39;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><pre><code>0    Single
1    Couple
2    Single
3    Couple
4    Couple
5    Couple
6    Single
7    Couple
8    Single
9    Couple
Name: Martial_status, dtype: object
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;Couple&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Single&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">fit</span><span class="o">.</span><span class="n">Martial_status</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><pre><code>0    1
1    0
2    1
3    0
4    0
5    0
6    1
7    0
8    1
9    0
Name: Martial_status, dtype: int64
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[[</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">,</span><span class="s1">&#39;Relationship&#39;</span><span class="p">,</span><span class="s1">&#39;Salary&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Relationship&#39;</span><span class="p">,</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:center">Relationship</th>
<th style="text-align:center">Martial_status</th>
<th style="text-align:center">Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Husband</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0.544331</td>
</tr>
<tr>
<td style="text-align:center">Not-in-family</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0.714286</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.893802</td>
</tr>
<tr>
<td style="text-align:center">Other-relative</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0.857143</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.976623</td>
</tr>
<tr>
<td style="text-align:center">Own-child</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0.821429</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.988818</td>
</tr>
<tr>
<td style="text-align:center">Unmarried</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.933686</td>
</tr>
<tr>
<td style="text-align:center">Wife</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0.506401</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">rel_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39; Unmarried&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39; Wife&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; Husband&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39; Not-in-family&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39; Own-child&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39; Other-relative&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>
</code></pre></div><pre><code>fit['Relationship'] =fit['Relationship'].map(rel_map)
</code></pre><pre><code>fit.head(10)
</code></pre><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>WorkClass</th>
<th>Final_weight</th>
<th>Education</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Occupation</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
<th>Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>State-gov</td>
<td>77516</td>
<td>Bachelors</td>
<td>13</td>
<td>1</td>
<td>Adm-clerical</td>
<td>3</td>
<td>White</td>
<td>1</td>
<td>2174</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>Self-emp-not-inc</td>
<td>83311</td>
<td>Bachelors</td>
<td>13</td>
<td>0</td>
<td>Exec-managerial</td>
<td>2</td>
<td>White</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>38</td>
<td>Private</td>
<td>215646</td>
<td>HS-grad</td>
<td>9</td>
<td>1</td>
<td>Handlers-cleaners</td>
<td>3</td>
<td>White</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>53</td>
<td>Private</td>
<td>234721</td>
<td>11th</td>
<td>7</td>
<td>0</td>
<td>Handlers-cleaners</td>
<td>2</td>
<td>Black</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>28</td>
<td>Private</td>
<td>338409</td>
<td>Bachelors</td>
<td>13</td>
<td>0</td>
<td>Prof-specialty</td>
<td>1</td>
<td>Black</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>37</td>
<td>Private</td>
<td>284582</td>
<td>Masters</td>
<td>14</td>
<td>0</td>
<td>Exec-managerial</td>
<td>1</td>
<td>White</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>49</td>
<td>Private</td>
<td>160187</td>
<td>9th</td>
<td>5</td>
<td>1</td>
<td>Other-service</td>
<td>3</td>
<td>Black</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>16</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>52</td>
<td>Self-emp-not-inc</td>
<td>209642</td>
<td>HS-grad</td>
<td>9</td>
<td>0</td>
<td>Exec-managerial</td>
<td>2</td>
<td>White</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>45</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>8</td>
<td>31</td>
<td>Private</td>
<td>45781</td>
<td>Masters</td>
<td>14</td>
<td>1</td>
<td>Prof-specialty</td>
<td>3</td>
<td>White</td>
<td>0</td>
<td>14084</td>
<td>0</td>
<td>50</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>9</td>
<td>42</td>
<td>Private</td>
<td>159449</td>
<td>Bachelors</td>
<td>13</td>
<td>0</td>
<td>Exec-managerial</td>
<td>2</td>
<td>White</td>
<td>1</td>
<td>5178</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">x</span><span class="o">=</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;hours_per_week&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;lime&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img
        class="lazyload"
        src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/svg/loading.min.svg"
        data-src="ML_Final_Project_files/ML_Final_Project_36_0.png"
        data-srcset="ML_Final_Project_files/ML_Final_Project_36_0.png, ML_Final_Project_files/ML_Final_Project_36_0.png 1.5x, ML_Final_Project_files/ML_Final_Project_36_0.png 2x"
        data-sizes="auto"
        alt="ML_Final_Project_files/ML_Final_Project_36_0.png"
        title="png" /></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[[</span><span class="s1">&#39;Race&#39;</span><span class="p">,</span><span class="s1">&#39;Salary&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Race&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:center">Race</th>
<th style="text-align:center">Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Amer-Indian-Eskimo</td>
<td style="text-align:center">0.881119</td>
</tr>
<tr>
<td style="text-align:center">Asian-Pac-Islander</td>
<td style="text-align:center">0.722905</td>
</tr>
<tr>
<td style="text-align:center">Black</td>
<td style="text-align:center">0.870075</td>
</tr>
<tr>
<td style="text-align:center">Other</td>
<td style="text-align:center">0.909091</td>
</tr>
<tr>
<td style="text-align:center">White</td>
<td style="text-align:center">0.736282</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">race_map</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39; White&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39; Amer-Indian-Eskimo&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; Asian-Pac-Islander&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39; Black&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39; Other&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Race&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Race&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">race_map</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">fit</span><span class="o">.</span><span class="n">Race</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><pre><code>0    0
1    0
2    0
3    3
4    3
5    0
6    3
7    0
8    0
9    0
Name: Race, dtype: int64
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">fit</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;WorkClass&#39;</span><span class="p">,</span><span class="s1">&#39;Final_weight&#39;</span><span class="p">,</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span><span class="s1">&#39;Occupation&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
<th>Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>2174</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>38</td>
<td>9</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>53</td>
<td>7</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>28</td>
<td>13</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>37</td>
<td>14</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>49</td>
<td>5</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>16</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>52</td>
<td>9</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>45</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>8</td>
<td>31</td>
<td>14</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>14084</td>
<td>0</td>
<td>50</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>9</td>
<td>42</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>5178</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">x</span><span class="o">=</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Capital_loss&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;lime&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img
        class="lazyload"
        src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/svg/loading.min.svg"
        data-src="ML_Final_Project_files/ML_Final_Project_43_0.png"
        data-srcset="ML_Final_Project_files/ML_Final_Project_43_0.png, ML_Final_Project_files/ML_Final_Project_43_0.png 1.5x, ML_Final_Project_files/ML_Final_Project_43_0.png 2x"
        data-sizes="auto"
        alt="ML_Final_Project_files/ML_Final_Project_43_0.png"
        title="png" /></p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># Converting Capital gain to Numeric</span>
<span class="n">fit</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Capital_gain&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span><span class="s1">&#39;Capital_gain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fit</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Capital_gain&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">,</span><span class="s1">&#39;Capital_gain&#39;</span><span class="p">)]</span><span class="o">=</span> <span class="mi">0</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># Converting Capital Loss to Numeric</span>
<span class="n">fit</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Capital_loss&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span><span class="s1">&#39;Capital_loss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fit</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">fit</span><span class="p">[</span><span class="s1">&#39;Capital_loss&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">,</span><span class="s1">&#39;Capital_loss&#39;</span><span class="p">)]</span><span class="o">=</span> <span class="mi">0</span>
<span class="n">fit</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
<th>Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>38</td>
<td>9</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>53</td>
<td>7</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>28</td>
<td>13</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>37</td>
<td>14</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>49</td>
<td>5</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>16</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>52</td>
<td>9</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>45</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>8</td>
<td>31</td>
<td>14</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>50</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>9</td>
<td>42</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">heatmap</span> <span class="kn">import</span> <span class="n">heatmap</span><span class="p">,</span> <span class="n">corrplot</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">corrplot</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">size_scale</span><span class="o">=</span><span class="mi">300</span><span class="p">);</span>
</code></pre></div><p><img
        class="lazyload"
        src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/svg/loading.min.svg"
        data-src="ML_Final_Project_files/ML_Final_Project_48_0.png"
        data-srcset="ML_Final_Project_files/ML_Final_Project_48_0.png, ML_Final_Project_files/ML_Final_Project_48_0.png 1.5x, ML_Final_Project_files/ML_Final_Project_48_0.png 2x"
        data-sizes="auto"
        alt="ML_Final_Project_files/ML_Final_Project_48_0.png"
        title="png" /></p>
<pre><code>
</code></pre><h1 id="magic-begins">Magic begins</h1>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="kn">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="kn">as</span> <span class="nn">animation</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">shuffle</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">x</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">x</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Salary&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">x</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>38</td>
<td>9</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>53</td>
<td>7</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>28</td>
<td>13</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>0</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>32556</td>
<td>27</td>
<td>12</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>38</td>
<td>1</td>
</tr>
<tr>
<td>32557</td>
<td>40</td>
<td>9</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>32558</td>
<td>58</td>
<td>9</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>32559</td>
<td>22</td>
<td>9</td>
<td>1</td>
<td>4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>20</td>
<td>1</td>
</tr>
<tr>
<td>32560</td>
<td>52</td>
<td>9</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">y</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">y</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Education_num&#39;</span><span class="p">,</span><span class="s1">&#39;Martial_status&#39;</span><span class="p">,</span><span class="s1">&#39;Relationship&#39;</span><span class="p">,</span><span class="s1">&#39;Race&#39;</span><span class="p">,</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span><span class="s1">&#39;Capital_gain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Capital_loss&#39;</span><span class="p">,</span><span class="s1">&#39;hours_per_week&#39;</span><span class="p">,</span><span class="s1">&#39;native_country&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">y</span>
</code></pre></div><pre><code>      Salary
0	    1
1	    1
2	    1
3	    1
4	    1
...	  ...
32556	1
32557	0
32558	1
32559	1
32560	0
</code></pre>
<p>30162 rows × 1 columns</p>
<h2 id="normalization">Normalization</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="c1"># Data Normalization</span>
<span class="n">normalized_X</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">X</span><span class="o">=</span> <span class="n">normalized_X</span> <span class="c1"># Normalised Data</span>
<span class="n">X</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X</span>
</code></pre></div><pre><code>array([[ 0.04279571,  1.12891838,  0.93606249, ..., -0.22284679,
        -0.07773411,  0.31087053],
       [ 0.88028814,  1.12891838, -1.06830474, ..., -0.22284679,
        -2.3315307 ,  0.31087053],
       [-0.03333996, -0.4397382 ,  0.93606249, ..., -0.22284679,
        -0.07773411,  0.31087053],
       ...,
       [ 1.48937355, -0.4397382 ,  0.93606249, ..., -0.22284679,
        -0.07773411,  0.31087053],
       [-1.25151078, -0.4397382 ,  0.93606249, ..., -0.22284679,
        -1.74721307,  0.31087053],
       [ 1.0325595 , -0.4397382 , -1.06830474, ..., -0.22284679,
        -0.07773411,  0.31087053]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">y</span>
</code></pre></div><pre><code>array([[1],
       [1],
       [1],
       ...,
       [1],
       [1],
       [0]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">X</span><span class="p">))</span>
<span class="n">X</span>
</code></pre></div><pre><code>array([[ 1.        ,  0.04279571,  1.12891838, ..., -0.22284679,
        -0.07773411,  0.31087053],
       [ 1.        ,  0.88028814,  1.12891838, ..., -0.22284679,
        -2.3315307 ,  0.31087053],
       [ 1.        , -0.03333996, -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053],
       ...,
       [ 1.        ,  1.48937355, -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053],
       [ 1.        , -1.25151078, -0.4397382 , ..., -0.22284679,
        -1.74721307,  0.31087053],
       [ 1.        ,  1.0325595 , -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
                                                <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                                                <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div><pre><code>(22621, 7541)
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">compute_cost</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="c1"># calculate hinge loss</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Y</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span>
    <span class="n">distances</span><span class="p">[</span><span class="n">distances</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># equivalent to max(0, distance)</span>
    <span class="n">hinge_loss</span> <span class="o">=</span> <span class="n">regularization_strength</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># calculate cost</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span> <span class="o">+</span> <span class="n">hinge_loss</span>
    <span class="k">return</span> <span class="n">cost</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">calculate_cost_gradient</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">X_batch</span><span class="p">,</span> <span class="n">Y_batch</span><span class="p">):</span>
    <span class="c1"># if only one example is passed (eg. in case of SGD)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">Y_batch</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
        <span class="n">Y_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Y_batch</span><span class="p">])</span>
        <span class="n">X_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_batch</span><span class="p">])</span>  <span class="c1"># gives multidimensional array</span>

    <span class="n">distance</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">Y_batch</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_batch</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">distance</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">di</span> <span class="o">=</span> <span class="n">W</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">di</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="p">(</span><span class="n">regularization_strength</span> <span class="o">*</span> <span class="n">Y_batch</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">X_batch</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
        <span class="n">dw</span> <span class="o">+=</span> <span class="n">di</span>

    <span class="n">dw</span> <span class="o">=</span> <span class="n">dw</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">Y_batch</span><span class="p">)</span>  <span class="c1"># average</span>
    <span class="k">return</span> <span class="n">dw</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">sgd</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
    <span class="n">max_epochs</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">nth</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">prev_cost</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&#34;inf&#34;</span><span class="p">)</span>
    <span class="n">cost_threshold</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># in percent</span>
    <span class="n">J_history</span><span class="o">=</span><span class="p">[]</span>
    <span class="c1"># stochastic gradient descent</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_epochs</span><span class="p">):</span>
        <span class="c1"># shuffle to prevent repeating update cycles</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">shuffle</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
            <span class="n">ascent</span> <span class="o">=</span> <span class="n">calculate_cost_gradient</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">-</span> <span class="p">(</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">ascent</span><span class="p">)</span>

        <span class="c1"># convergence check on 2^nth epoch</span>
        <span class="k">if</span> <span class="n">epoch</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">nth</span> <span class="ow">or</span> <span class="n">epoch</span> <span class="o">==</span> <span class="n">max_epochs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cost</span> <span class="o">=</span> <span class="n">compute_cost</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&#34;Epoch is: {} and Cost is: {}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">cost</span><span class="p">))</span>
            <span class="c1"># stoppage criterion</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">prev_cost</span> <span class="o">-</span> <span class="n">cost</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">cost_threshold</span> <span class="o">*</span> <span class="n">prev_cost</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">weights</span>
            <span class="n">prev_cost</span> <span class="o">=</span> <span class="n">cost</span>
            <span class="n">nth</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">J_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">weights</span><span class="p">,</span><span class="n">J_history</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">regularization_strength</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.5</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Training the model</span>
<span class="n">W</span><span class="p">,</span><span class="n">J_history</span><span class="o">=</span><span class="n">sgd</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</code></pre></div><pre><code>Epoch is: 1 and Cost is: 64950616.66954408
Epoch is: 2 and Cost is: 85814516.7868933
Epoch is: 4 and Cost is: 2244751.1160014216
Epoch is: 8 and Cost is: 45447118.64829404
Epoch is: 16 and Cost is: 14714540.629473215
Epoch is: 32 and Cost is: 4344601.036239334
Epoch is: 64 and Cost is: 37090385.394482166
Epoch is: 99 and Cost is: 46900813.34246465
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">W</span>
</code></pre></div><pre><code>array([7.06868769, 7.06868769, 7.06868769])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="s2">&#34;training the model...&#34;</span><span class="p">)</span>
<span class="n">y_train_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">W</span><span class="p">))</span>
    <span class="n">y_train_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_train_predicted</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
</code></pre></div><pre><code>training the model...
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">y_train_predicted</span>
</code></pre></div><pre><code>array([ 1.,  1., -1., ...,  1.,  1.,  1.])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">y_test_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">W</span><span class="p">))</span>
    <span class="n">y_test_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_test_predicted</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="s2">&#34;accuracy on test dataset: {}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_predicted</span><span class="p">)))</span>
</code></pre></div><pre><code>accuracy on test dataset: 0.4894576316138443
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_predicted</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#converting y_test to one dimension</span>
<span class="n">abc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">abc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">abc</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y_Actual&#39;</span><span class="p">:</span>    <span class="n">abc</span><span class="p">,</span>
        <span class="s1">&#39;y_Predicted&#39;</span><span class="p">:</span> <span class="n">y_test_predicted</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y_Actual&#39;</span><span class="p">,</span><span class="s1">&#39;y_Predicted&#39;</span><span class="p">])</span>
<span class="n">confusion_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_Actual&#39;</span><span class="p">],</span>
                               <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_Predicted&#39;</span><span class="p">],</span>
                               <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Actual&#39;</span><span class="p">],</span>
                               <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicted&#39;</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img
        class="lazyload"
        src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/svg/loading.min.svg"
        data-src="ML_Final_Project_files/ML_Final_Project_79_0.png"
        data-srcset="ML_Final_Project_files/ML_Final_Project_79_0.png, ML_Final_Project_files/ML_Final_Project_79_0.png 1.5x, ML_Final_Project_files/ML_Final_Project_79_0.png 2x"
        data-sizes="auto"
        alt="ML_Final_Project_files/ML_Final_Project_79_0.png"
        title="png" /></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">confusion_matrix</span>
</code></pre></div><table>
<thead>
<tr>
<th>Predicted/Actual</th>
<th>-1.0</th>
<th>1.0</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>0</td>
<td>82</td>
<td>1797</td>
</tr>
<tr>
<td>1</td>
<td>1971</td>
<td>3691</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_score</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div><pre><code>/usr/local/lib/python3.6/dist-packages/sklearn/utils/validation.py:760: DataConversionWarning:
A column-vector y was passed when a 1d array was expected.
Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">average_precision_score</span>
<span class="n">average_precision</span> <span class="o">=</span> <span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_score</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Average Precision-Recall score : {0:0.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">average_precision</span><span class="p">))</span>
</code></pre></div><pre><code>Average Precision-Recall score : 0.95
</code></pre>
<h2 id="pca">PCA</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">principalComponents</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">principalDf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">principalComponents</span>
             <span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;principal component 1&#39;</span><span class="p">,</span> <span class="s1">&#39;principal component 2&#39;</span><span class="p">])</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">principalDf</span>
</code></pre></div><pre><code>array([[ 0.3611508 , -1.06582651],
       [ 0.48002773,  0.03450933],
       [-0.41751607, -0.62298376],
       ...,
       [ 0.09665751,  1.5659688 ],
       [-1.40701567, -1.13857703],
       [ 1.0930337 ,  1.08675433]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">principalDf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">principalDf</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">coef0</span><span class="o">=</span><span class="mf">13.19098827</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">principalDf</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">22621</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">22621</span><span class="p">])</span>
</code></pre></div><pre><code>/usr/local/lib/python3.6/dist-packages/sklearn/utils/validation.py:760: DataConversionWarning:
A column-vector y was passed when a 1d array was expected.
Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)

SVC(C=100, break_ties=False, cache_size=200, class_weight=None,
    coef0=13.19098827, decision_function_shape='ovr', degree=3, gamma='scale',
    kernel='linear', max_iter=-1, probability=False, random_state=None,
    shrinking=True, tol=0.001, verbose=False)
</code></pre>
<h2 id="svm-on-training-dataset">SVM on Training Dataset</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">22621</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">principalDf</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">22621</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">principalDf</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">22621</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">YY</span><span class="p">,</span> <span class="n">XX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span> <span class="n">xx</span><span class="p">)</span>
<span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">XX</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">YY</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">XX</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
           <span class="n">linestyles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">support_vectors_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="n">support_vectors_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
           <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Estimated Salary&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X (Predictor)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SVM Classification on training dataset&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img
        class="lazyload"
        src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/svg/loading.min.svg"
        data-src="ML_Final_Project_files/ML_Final_Project_88_0.png"
        data-srcset="ML_Final_Project_files/ML_Final_Project_88_0.png, ML_Final_Project_files/ML_Final_Project_88_0.png 1.5x, ML_Final_Project_files/ML_Final_Project_88_0.png 2x"
        data-sizes="auto"
        alt="ML_Final_Project_files/ML_Final_Project_88_0.png"
        title="png" /></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python">
<span class="n">model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">coef0</span><span class="o">=</span><span class="mf">13.19098827</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">principalDf</span><span class="p">[</span><span class="mi">22621</span><span class="p">:],</span> <span class="n">y</span><span class="p">[</span><span class="mi">22621</span><span class="p">:])</span>
</code></pre></div><pre><code>/usr/local/lib/python3.6/dist-packages/sklearn/utils/validation.py:760: DataConversionWarning: A column-vector y was passed when a 1d array was expected.
Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)

SVC(C=100, break_ties=False, cache_size=200, class_weight=None,
    coef0=13.19098827, decision_function_shape='ovr', degree=3, gamma='scale',
    kernel='linear', max_iter=-1, probability=False, random_state=None,
    shrinking=True, tol=0.001, verbose=False)
</code></pre>
<h2 id="svm-on-testing-dataset">SVM on Testing Dataset</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">y</span><span class="p">[</span><span class="mi">22621</span><span class="p">:]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">principalDf</span><span class="p">[</span><span class="mi">22621</span><span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">principalDf</span><span class="p">[</span><span class="mi">22621</span><span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">YY</span><span class="p">,</span> <span class="n">XX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span> <span class="n">xx</span><span class="p">)</span>
<span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">XX</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">YY</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">XX</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
           <span class="n">linestyles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">support_vectors_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="n">support_vectors_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
           <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Estimated Salary&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X (Predictor)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SVM Classification on testing dataset&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img
        class="lazyload"
        src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/svg/loading.min.svg"
        data-src="ML_Final_Project_files/ML_Final_Project_90_0.png"
        data-srcset="ML_Final_Project_files/ML_Final_Project_90_0.png, ML_Final_Project_files/ML_Final_Project_90_0.png 1.5x, ML_Final_Project_files/ML_Final_Project_90_0.png 2x"
        data-sizes="auto"
        alt="ML_Final_Project_files/ML_Final_Project_90_0.png"
        title="png" /></p>
<h2 id="logistic-regression">Logistic regression</h2>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">X</span>
</code></pre></div><pre><code>array([[ 1.        ,  0.04279571,  1.12891838, ..., -0.22284679,
        -0.07773411,  0.31087053],
       [ 1.        ,  0.88028814,  1.12891838, ..., -0.22284679,
        -2.3315307 ,  0.31087053],
       [ 1.        , -0.03333996, -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053],
       ...,
       [ 1.        ,  1.48937355, -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053],
       [ 1.        , -1.25151078, -0.4397382 , ..., -0.22284679,
        -1.74721307,  0.31087053],
       [ 1.        ,  1.0325595 , -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">m</span> <span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="n">X</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span>
</code></pre></div><pre><code>array([[ 1.        ,  0.04279571,  1.12891838, ..., -0.22284679,
        -0.07773411,  0.31087053],
       [ 1.        ,  0.88028814,  1.12891838, ..., -0.22284679,
        -2.3315307 ,  0.31087053],
       [ 1.        , -0.03333996, -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053],
       ...,
       [ 1.        ,  1.48937355, -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053],
       [ 1.        , -1.25151078, -0.4397382 , ..., -0.22284679,
        -1.74721307,  0.31087053],
       [ 1.        ,  1.0325595 , -0.4397382 , ..., -0.22284679,
        -0.07773411,  0.31087053]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div><pre><code>/usr/local/lib/python3.6/dist-packages/sklearn/utils/validation.py:760: DataConversionWarning:
A column-vector y was passed when a 1d array was expected.
Please change the shape of y to (n_samples, ),
for example using ravel().y = column_or_1d(y, warn=True)

LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
                   intercept_scaling=1, l1_ratio=None, max_iter=100,
                   multi_class='auto', n_jobs=None, penalty='l2',
                   random_state=None, solver='lbfgs', tol=0.0001, verbose=0,
                   warm_start=False)
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">costFunction</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

    <span class="n">m</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">theta</span><span class="p">))</span>
    <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">predictions</span><span class="p">))</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">predictions</span><span class="p">))</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

    <span class="n">grad</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),(</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">cost</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">grad</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">gradientDescent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">num_iters</span><span class="p">):</span>  
    <span class="n">m</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">J_history</span> <span class="o">=</span><span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iters</span><span class="p">):</span>
        <span class="n">cost</span><span class="p">,</span> <span class="n">grad</span> <span class="o">=</span> <span class="n">costFunction</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">grad</span><span class="p">)</span>
        <span class="n">J_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">theta</span> <span class="p">,</span> <span class="n">J_history</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">theta_result</span><span class="p">,</span><span class="n">cost_history</span><span class="o">=</span><span class="n">gradientDescent</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">initial_theta</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">num_iters</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">theta_result</span>
</code></pre></div><pre><code>array([[ 1.86802546],
       [-0.38192732],
       [-0.93415412],
       [ 1.08991493],
       [ 0.19253997],
       [ 0.08182571],
       [-0.09390707],
       [-0.45759634],
       [-0.22849672],
       [-0.34343411],
       [-0.06609421]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cost_history</span><span class="p">,</span><span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cost History&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Iterations&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cost History vs Number of Iterations&#39;</span><span class="p">)</span>
</code></pre></div><pre><code>Text(0.5, 1.0, 'Cost History vs Number of Iterations')
</code></pre>
<p><img
        class="lazyload"
        src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/svg/loading.min.svg"
        data-src="ML_Final_Project_files/ML_Final_Project_101_1.png"
        data-srcset="ML_Final_Project_files/ML_Final_Project_101_1.png, ML_Final_Project_files/ML_Final_Project_101_1.png 1.5x, ML_Final_Project_files/ML_Final_Project_101_1.png 2x"
        data-sizes="auto"
        alt="ML_Final_Project_files/ML_Final_Project_101_1.png"
        title="png" /></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">initial_theta</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">initial_theta</span>
</code></pre></div><pre><code>array([[0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0],
       [0]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">theta_result</span><span class="p">))</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">initial_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">cost</span><span class="p">,</span> <span class="n">grad</span><span class="o">=</span> <span class="n">costFunction</span><span class="p">(</span><span class="n">initial_theta</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Cost of initial theta is&#34;</span><span class="p">,</span><span class="n">cost</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Gradient at initial theta (zeros):&#34;</span><span class="p">,</span><span class="n">grad</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">classifierPredict</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">X</span><span class="p">):</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span><span class="o">&gt;</span><span class="mi">0</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">p</span><span class="o">=</span><span class="n">classifierPredict</span><span class="p">(</span><span class="n">theta_result</span><span class="p">,</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Test Accuracy:&#34;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="n">y_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div><pre><code>Test Accuracy: 6311
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</code></pre></div><pre><code>7541
</code></pre>
<h1 id="question-4">Question 4</h1>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">newdata</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">abc</span> <span class="o">=</span> <span class="n">newdata</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">abc</span><span class="o">.</span><span class="n">drop</span> <span class="p">([</span><span class="s1">&#39;Salary&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div><pre><code>/usr/local/lib/python3.6/dist-packages/pandas/core/frame.py:3997: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  errors=errors,
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">abc</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>38</td>
<td>9</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>53</td>
<td>7</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>28</td>
<td>13</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>0</td>
</tr>
<tr>
<td>5</td>
<td>37</td>
<td>14</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>49</td>
<td>5</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>16</td>
<td>0</td>
</tr>
<tr>
<td>7</td>
<td>52</td>
<td>9</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>45</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td>31</td>
<td>14</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>50</td>
<td>1</td>
</tr>
<tr>
<td>9</td>
<td>42</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">abc</span> <span class="o">=</span> <span class="n">abc</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">abc</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">dummy1</span>  <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">dummy2</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">dummy1</span> <span class="o">=</span> <span class="n">dummy1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dummy2</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">dummy1</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">dummy1</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;Education_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dummy1</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>39</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">abc</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;Education_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">13</span>
</code></pre></div><pre><code>/usr/local/lib/python3.6/dist-packages/pandas/core/indexing.py:671: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self._setitem_with_indexer(indexer, value)
/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:1: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">abc</span>
</code></pre></div><table>
<thead>
<tr>
<th></th>
<th>Age</th>
<th>Education_num</th>
<th>Martial_status</th>
<th>Relationship</th>
<th>Race</th>
<th>Sex</th>
<th>Capital_gain</th>
<th>Capital_loss</th>
<th>hours_per_week</th>
<th>native_country</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>39</td>
<td>13</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>40</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>50</td>
<td>4</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">abc</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abc</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">abc</span>
</code></pre></div><pre><code>array([[39, 13,  1,  3,  0,  1,  1,  0, 40,  1],
       [50,  4,  0,  2,  0,  1,  0,  0, 13,  1]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#standardizing abc</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="c1"># Data Normalization</span>
<span class="n">normalized_X</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dummy1</span><span class="p">)</span>
<span class="n">x1</span><span class="o">=</span> <span class="n">normalized_X</span> <span class="c1"># Normalised Data</span>
<span class="n">y</span> <span class="c1"># Price</span>
<span class="n">x1</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">x1</span>
</code></pre></div><pre><code>array([[ 0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0., -1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">y1</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y1</span>
</code></pre></div><pre><code>array([[1],
       [1]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">x1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">x1</span><span class="p">))</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">x1</span>
</code></pre></div><pre><code>array([[ 1.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0., -1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">theta_result</span><span class="p">))</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">z</span>
</code></pre></div><pre><code>array([[0.71786004],
       [0.94279349]])
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"> <span class="mi">1</span><span class="o">-</span><span class="n">z</span>
</code></pre></div><pre><code>array([[0.28213996],
       [0.05720651]])
</code></pre></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-09-05</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/machine-learning-final-project/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/tags/linear-regression/">Linear Regression</a>,&nbsp;<a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/tags/svm/">SVM</a>,&nbsp;<a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/tags/sgd/">SGD</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/ronaldo/" class="prev" rel="prev" title="Cristiano Ronaldo&#39;s Success"><i class="fas fa-angle-left fa-fw"></i>Cristiano Ronaldo&#39;s Success</a>
            <a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/posts/germany-world-cup/" class="next" rel="next" title="Germany&#39;s Dominance in FIFA World Cup using Tableau">Germany&#39;s Dominance in FIFA World Cup using Tableau<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.80.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/" target="_blank">Vamsi Akhumukhi</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":100},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="https://vamsi-akhumukhi.github.io/Vamsi-Portfolio/js/theme.min.js"></script></body>
</html>
